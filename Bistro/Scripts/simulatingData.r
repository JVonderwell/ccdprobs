## r script to simulate data from the cats-dogs tree
## Claudia September 2016

source("old/genetrees.R")
source("old/branch-length_lik.R")
source("old/transformRates.r")

seed = 1234
set.seed(seed)

nsites = 1500
alpha = 1000
tree.text = "(cheetah:0.11850973637208513101,((((snow_leopard:0.04020488777776567990,leopard:0.03846672365840048818):0.01445254156731264929,tiger:0.07079306712878565000):0.01190623639760595223,clouded_leopard:0.10461902411036745619):0.04344639957238824457,(red_fox:0.11974055940327851810,(((coyote:0.00840558068745050208,(gray_wolf:0.00206050882985083861,dog:0.00185256446369396789):0.03205946058703370433):0.02609285257533808938,dhole:0.07049077201732806275):0.13276609809571754406,raccoon_dog:0.15542990325076813662):0.07955504846187926027):0.79869116234474835103):0.03995629108638096977,cat:0.03751335233479641956):0.0;"
tree = read.tree(text=tree.text)

## from cats-dogs-no-fixed-q.nex.pstat
p = c(0.2429295,0.2356097,0.2067433,0.3147175)
r = c(0.05274190, 0.3742855, 0.05746096, 0.01611567, 0.4916158, 0.007780191)

s = getS(c(r,p))
s = s[1:6]
s = s/s[6]
Q = makeQfromS(s,p,4)

x = simData(tree,nsites,Q,alpha)
